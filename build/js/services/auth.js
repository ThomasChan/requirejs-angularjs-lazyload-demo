define(["angular"],function(o){o.module("application.Auth",["application.Mentor","application.User"]).factory("Auth",["$http","$cookies","$q",function(o,e,t){var s=function(o){e.put("token",o)},r=function(){e.remove("token")},a={filterParams:function(o){return o.phone&&FILTER.isPhone(o.phone)?o.vcode&&FILTER.isVcode(o.vcode)?o.nickname&&FILTER.isNickname(o.nickname)?o.password&&FILTER.isPassword(o.password)?{code:0}:{code:1,error:"密码含有不合法字符"}:{code:1,error:"昵称可以是汉字、数字、下划线、大小写字母组成，至少 3 位，至多 20 位"}:{code:1,error:"请输入 6 位数字手机验证码"}:{code:1,error:"请输入正确的 11 位手机号码"}},"do":function(e){return o.post(API.register.url,{params:e})}},n={filterParams:function(o){return console.log(o),o.phone&&FILTER.isPhone(o.phone)?o.password&&FILTER.isPassword(o.password)?{code:0}:{code:1,error:"密码含有不合法字符"}:{code:1,error:"请输入正确的 11 位手机号码"}},"do":function(r){return t(function(t,a){o.post(API.login.url,{params:r}).then(function(o){s(o.data.token),e.put("is_login",!0),t(o)},function(o){a(o)})})}},d={"do":function(){return t(function(t,s){o.get(API.logout.url).then(function(o){200===o.status&&200===o.data.code?(r(),e.remove("is_login"),e.get("is_mentor")&&e.remove("is_mentor"),t(o)):s(o)},function(o){s(o)})})}},l=function(){return e.get("is_login")?!0:!1},i=function(){return e.get("is_mentor")?!0:!1};return{isLogin:l,isMentor:i,register:a,login:n,logout:d,sendPhoneVcode:{"do":function(e){return o.post(API.sendPhoneVcode.url,e)},url:host+"SendPhoneVcode",method:"post",params:{phone:""}},validatePhone:{url:host+"ValidatePhone",method:"post",params:{phone:"",vcode:""}},validateRealName:{url:host+"ValidateRealName",method:"post",params:{realname:"",idcard:""}},getRealnameStatus:{url:host+"GetRealnameStatus"},updatePassword:{url:host+"UpdatePassword",method:"post",params:{old_password:"",new_password:""}},updateUserHighschoolInfo:{url:host+"UpdateUserHighschoolInfo",method:"post",params:{hs_name:"",hs_adm_year:"",hs_adm_month:"",hs_gra_year:"",hs_gra_month:"",hs_grade:"",hs_class:"",hs_stuid:"",hs_hum_sci:"",hs_status:""}},getUserHighschoolStatus:{url:host+"GetUserHighschoolStatus"},updateUserCollegeInfo:{url:host+"UpdateUserCollegeInfo",method:"post",params:{col_name:"",col_dept:"",col_adm_year:"",col_adm_month:"",col_gra_year:"",col_gra_month:"",col_grade:"",col_class:"",col_stuid:"",col_status:""}},getUserCollegeStatus:{url:host+"GetUserCollegeStatus"},addUserTags:{url:host+"AddUserTags",method:"post",params:{tag:""}},deleteUserTags:{url:host+"DeleteUserTags",method:"post",params:{tag:""}}}}])});