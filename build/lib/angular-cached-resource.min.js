!function e(r,t,n){function o(a,i){if(!t[a]){if(!r[a]){var s="function"==typeof require&&require;if(!i&&s)return s(a,!0);if(u)return u(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=t[a]={exports:{}};r[a][0].call(l.exports,function(e){var t=r[a][1][e];return o(t?t:e)},l,l.exports,e,r,t,n)}return t[a].exports}for(var u="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,r,t){var n,o,u,a,i;n={get:{method:"GET"},query:{method:"GET",isArray:!0},save:{method:"POST"},remove:{method:"DELETE"},"delete":{method:"DELETE"}},u=e("./read_array_cache"),a=e("./read_cache"),i=e("./write_cache"),r.exports=o=function(r,t,o,s,c){var l,h,f,p,d,y,m,g,v,_,$,w,b,P,x,k,q,C,O,j;for(h=s.$log,m=e("./resource_cache_entry")(s),y=e("./resource_cache_array_entry")(s),g=e("./resource_write_queue")(s,o),f=e("./cache")(s),l=c.shift(),j=c.shift();c.length;)w=c.pop(),angular.isObject(w[Object.keys(w)[0]])?$=w:O=w;$=angular.extend({},n,$),null==O&&(O={}),b={};for(q in O)C=O[q],"@"===C[0]&&(b[C.substr(1)]=q);d=r.call(null,j,O,$),x=function(e){return angular.isDate(e)||angular.isNumber(e)||angular.isString(e)},p=function(){function e(e){angular.extend(this,e)}return e.prototype.$cache=!0,e.prototype.toJSON=function(){var e;return e=angular.extend({},this),delete e.$promise,delete e.$httpPromise,e},e.prototype.$params=function(){var e,r;r={};for(e in b)q=b[e],x(this[e])&&(r[q]=this[e]);return r},e.prototype.$$addToCache=function(e){var r;return null==e&&(e=!1),r=new m(l,this.$params()),r.set(this,e),this},e.$clearCache=function(r){var t,n,o,u,a,i,s,c,p,d,g,v,_,$,w,b;return w=null!=r?r:{},$=w.where,i=w.exceptFor,u=w.clearPendingWrites,s=w.isArray,o=w.clearChildren,null==$&&($=null),null==i&&(i=null),null==u&&(u=!1),null==s&&(s=!1),null==o&&(o=!1),$&&i?h.error("Using where and exceptFor arguments at once in $clearCache() method is forbidden!"):(n=[],_=function(r){return r||(r=[]),angular.isArray(r)||(r=[r]),r.map(function(r){return new e(r).$params()})},g=function(e){return e.map(function(e){return new m(l,e).fullCacheKey()})},v=function(e){return g(_(e))},(i||$)&&(s?(t=new y(l,i||$).load(),n.push(t.fullCacheKey()),t.value&&(i&&!o||$&&o)&&(a=function(){var e,r,n,o;for(n=t.value,o=[],e=0,r=n.length;r>e;e++)p=n[e],o.push(p);return o}(),a&&(n=n.concat(g(a))))):n=v($||i)),u||$?u&&$&&h.debug("TODO if clearPendingWrites && where"):(b=e.$writes,d=b.queue,c=b.key,n.push(c),a=d.map(function(e){return e.resourceParams}),n=n.concat(g(a))),$?f.clear({key:l,where:n}):f.clear({key:l,exceptFor:n}))},e.$addToCache=function(r,t){return new e(r).$$addToCache(t)},e.$addArrayToCache=function(r,t,n){return null==n&&(n=!1),t=t.map(function(r){return new e(r)}),new y(l,r).addInstances(t,n)},e.$resource=d,e.$key=l,e}(),p.$writes=new g(p,t);for(_ in $)v=$[_],k=v.method.toUpperCase(),v.cache!==!1?(P="GET"===k&&v.isArray?u(o,s,_,p,v):"GET"===k?a(o,s,_,p,v):"POST"===k||"PUT"===k||"DELETE"===k||"PATCH"===k?i(o,s,_,p,v):void 0,p[_]=P,"GET"!==k&&(p.prototype["$"+_]=P)):(p[_]=d[_],p.prototype["$"+_]=d.prototype["$"+_]);return p}},{"./cache":2,"./read_array_cache":7,"./read_cache":8,"./resource_cache_array_entry":9,"./resource_cache_entry":10,"./resource_write_queue":11,"./write_cache":12}],2:[function(e,r,t){var n,o;o=window.localStorage,n=function(){function e(e){this.$log=e.$log,this.localStoragePrefix=e.localStoragePrefix}return e.prototype.memoryCache={},e.prototype.getItem=function(e,r){var t,n;return e=this._buildKey(e),t=this.memoryCache[e],null==t&&(t=o.getItem(e)),n=null!=t?angular.fromJson(t):r,this.$log.debug("CACHE GET: "+e,n),n},e.prototype.setItem=function(e,r){var t,n;e=this._buildKey(e),n=angular.toJson(r);try{o.setItem(e,n),null!=this.memoryCache[e]&&delete this.memoryCache[e]}catch(u){t=u,this.$log.error("Failed to write to localStorage.",{error:t,key:e,value:n}),this.memoryCache[e]=n}return this.$log.debug("CACHE PUT: "+e,angular.fromJson(angular.toJson(r))),r},e.prototype.clear=function(e){var r,t,n,u,a,i,s,c,l,h,f,p,d,y,m,g,v,_,$;if(g=null!=e?e:{},i=g.key,n=g.exceptFor,c=g.where,c&&n)return this.$log.error("Using where and exceptFor arguments at once in clear() method is forbidden!");if(n){for(null==n&&(n=[]),t=[],a=l=0,v=o.length;v>=0?v>l:l>v;a=v>=0?++l:--l)if(r=o.key(a),this._cacheKeyHasPrefix(r,i)){for(s=!1,h=0,d=n.length;d>h;h++)if(u=n[h],this._cacheKeyHasPrefix(r,u)){s=!0;break}s||t.push(r)}for(_=[],f=0,y=t.length;y>f;f++)r=t[f],_.push(o.removeItem(r));return _}for($=[],p=0,m=c.length;m>p;p++)r=c[p],$.push(o.removeItem(this._buildKey(r)));return $},e.prototype._buildKey=function(e){return""+this.localStoragePrefix+e},e.prototype._cacheKeyHasPrefix=function(e,r){var t,n;return null==r?0===e.indexOf(this.localStoragePrefix):(r=this._buildKey(r),t=e.indexOf(r),n=e[r.length],0===t&&(null==n||"?"===n||"/"===n))},e}(),r.exports=function(e){return new n(e)}},{}],3:[function(e,r,t){var n=[].indexOf||function(e){for(var r=0,t=this.length;t>r;r++)if(r in this&&this[r]===e)return r;return-1};r.exports=function(r){var t,o,u;return u=e("./build_cached_resource_class"),t=e("./cache")(r),o=function(){function e(e,t,n){this.byKey={},this.build=angular.bind(this,u,e,t,n,r)}return e.prototype.keys=function(){return Object.keys(this.byKey)},e.prototype.add=function(){var e,r;return r=Array.prototype.slice.call(arguments),e=this.build(r),this.byKey[e.$key]=e,e.$writes.flush(),e},e.prototype.flushQueues=function(){var e,r,t,n;t=this.byKey,n=[];for(r in t)e=t[r],n.push(e.$writes.flush());return n},e.prototype.clearCache=function(e){var r,t,o,u,a,i,s;a=null!=e?e:{},o=a.exceptFor,t=a.clearPendingWrites,null==o&&(o=[]),i=this.byKey,s=[];for(u in i)r=i[u],n.call(o,u)<0&&s.push(r.$clearCache({clearPendingWrites:t}));return s},e.prototype.clearUndefined=function(){return t.clear({exceptFor:this.keys()})},e}()}},{"./build_cached_resource_class":1,"./cache":2}],4:[function(e,r,t){var n,o,u,a,i,s,c=[].slice;s=null,a=!1,i=null,"undefined"!=typeof r&&null!==r&&(r.exports=u=angular.module("ngCachedResource",["ngResource"])),u.provider("$cachedResource",o=function(){function e(){this.$get=n,i="cachedResource://"}return e.prototype.setDebugMode=function(e){return null==e&&(e=!0),a=e},e.prototype.setLocalStoragePrefix=function(e){return i=e},e}()),n=["$resource","$timeout","$q","$log",function(r,t,n,o){var u,l,h,f,p,d,y,m,g;for(h=function(e){return function(){var r;return r=1<=arguments.length?c.call(arguments,0):[],r.unshift("ngCachedResource"),o[e].apply(o,r)}},p={localStoragePrefix:i,$log:{debug:a?h("debug"):function(){},error:h("error")}},l=e("./cached_resource_manager")(p),d=new l(r,t,n),s&&document.removeEventListener("online",s),s=function(e){return d.flushQueues()},document.addEventListener("online",s),u=function(){return d.add.apply(d,arguments)},g=["clearCache","clearUndefined"],y=0,m=g.length;m>y;y++)f=g[y],u[f]=angular.bind(d,d[f]);return u}]},{"./cached_resource_manager":3}],5:[function(e,r,t){var n;r.exports=n=function(e,r,t){var o,u,a,i,s,c,l,h,f;for(h=Object.keys(e),i=0,c=h.length;c>i;i++)o=h[i],"$"!==o[0]&&(u=t&&null==t[o],null!=r[o]||u||delete e[o]);for(f=Object.keys(r),s=0,l=f.length;l>s;s++)o=f[s],"$"!==o[0]&&(angular.isObject(e[o])&&angular.isObject(r[o])?n(e[o],r[o],null!=t?t[o]:void 0):(a=t&&!angular.equals(e[o],t[o]),angular.equals(e[o],r[o])||a||(e[o]=r[o])));return null!=r.length?e.length=r.length:void 0}},{}],6:[function(e,r,t){var n;r.exports=n=function(e,r){var t,n,o,u;return r=Array.prototype.slice.call(r),o=angular.isObject(r[0])?r.shift():{},u=r[0],n=r[1],t=e.defer(),angular.isFunction(u)&&t.promise.then(u),angular.isFunction(n)&&t.promise["catch"](n),{params:o,deferred:t}}},{}],7:[function(e,r,t){var n,o,u,a=[].slice;o=e("./process_read_args"),n=e("./modify_object_in_place"),r.exports=u=function(r,t,u,i,s){var c,l,h;return l=e("./resource_cache_entry")(t),c=e("./resource_cache_array_entry")(t),h=function(e,r){var t,n,o,u,a;for(t=null,u=0,a=e.length;a>u;u++)if(n=e[u],o=n.$params(),Object.keys(r).every(function(e){return o[e]===r[e]})){t=n;break}return t},function(){var e,t,f,p,d,y,m,g,v,_,$,w;if($=o(r,arguments),m=$.params,f=$.deferred,y=r.defer(),e=new Array,e.$promise=f.promise,e.$httpPromise=y.promise,t=new c(i.$key,m).load(),e.$push=function(r){return e.push(r),t.addInstances([r],!1,{append:!0})},e.$httpPromise.then(function(e){return t.addInstances(e,!1)}),g=function(){var r;return r=i.$resource[u](m),r.$promise.then(function(r){var o;return o=new Array,r.map(function(r){var t;return r=new i(r),t=h(e,r.$params()),t?(n(t,r),o.push(t)):o.push(r)}),e.splice.apply(e,[0,e.length].concat(a.call(o))),t.value||f.resolve(e),y.resolve(e)}),r.$promise["catch"](function(e){return t.value||f.reject(e),y.reject(e)})},s.cacheOnly||i.$writes.flush(g),t.value){for(w=t.value,v=0,_=w.length;_>v;v++)d=w[v],p=new l(i.$key,d).load(),e.push(new i(p.value));f.resolve(e)}else s.cacheOnly&&f.reject(new Error("Cache value does not exist for params",m));return e}}},{"./modify_object_in_place":5,"./process_read_args":6,"./resource_cache_array_entry":9,"./resource_cache_entry":10}],8:[function(e,r,t){var n,o,u;o=e("./process_read_args"),n=e("./modify_object_in_place"),r.exports=u=function(r,t,u,a,i){var s;return s=e("./resource_cache_entry")(t),function(){var e,c,l,h,f,p,d;return d=o(r,arguments),f=d.params,e=d.deferred,l=r.defer(),h=new a({$promise:e.promise,$httpPromise:l.promise}),c=new s(a.$key,f).load(),p=function(){var r;return r=a.$resource[u].call(a.$resource,f),r.$promise.then(function(r){return n(h,r),c.value||e.resolve(h),l.resolve(h),c.dirty&&t.$log.error("unexpectedly setting a clean entry (load) over a dirty entry (pending write)"),c.set(r,!1)}),r.$promise["catch"](function(r){return c.value||e.reject(r),l.reject(r)})},c.dirty?a.$writes.processResource(f,p):i.cacheOnly||p(),c.value?(angular.extend(h,c.value),e.resolve(h)):i.cacheOnly&&e.reject(new Error("Cache value does not exist for params",f)),h}}},{"./modify_object_in_place":5,"./process_read_args":6,"./resource_cache_entry":10}],9:[function(e,r,t){var n={}.hasOwnProperty,o=function(e,r){function t(){this.constructor=e}for(var o in r)n.call(r,o)&&(e[o]=r[o]);return t.prototype=r.prototype,e.prototype=new t,e.__super__=r.prototype,e};r.exports=function(r){var t,n,u;return t=r.$log,u=e("./resource_cache_entry")(r),n=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return o(r,e),r.prototype.defaultValue=[],r.prototype.cacheKeyPrefix=function(){return""+this.key+"/array"},r.prototype.addInstances=function(e,r,n){var o,a,i,s,c,l;for(null==n&&(n={append:!1}),o=n.append?this.value:[],null==o&&(o=[]),c=0,l=e.length;l>c;c++)s=e[c],i=s.$params(),0===Object.keys(i).length?t.error("'"+this.key+"' instance doesn't have any boundParams. Please, make sure you specified them in your resource's initialization, f.e. `{id: \"@id\"}`, or it won't be cached."):(o.push(i),a=new u(this.key,i).load(),n.append&&null!=a.value||a.set(s,r));return this.set(o,r)},r}(u)}},{"./resource_cache_entry":10}],10:[function(e,r,t){r.exports=function(r){var t,n,o;return t=r.$log,n=e("./cache")(r),o=function(){function e(e,r){var t,n;this.key=e,n=angular.isObject(r)?Object.keys(r).sort():[],n.length?this.cacheKeyParams="?"+function(){var e,o,u;for(u=[],e=0,o=n.length;o>e;e++)t=n[e],u.push(""+t+"="+r[t]);return u}().join("&"):this.cacheKeyParams=""}return e.prototype.defaultValue={},e.prototype.cacheKeyPrefix=function(){return this.key},e.prototype.fullCacheKey=function(){return this.cacheKeyPrefix()+this.cacheKeyParams},e.prototype.load=function(){var e;return e=n.getItem(this.fullCacheKey(),this.defaultValue),this.value=e.value,this.dirty=e.dirty,this},e.prototype.set=function(e,r){return this.value=e,this.dirty=r,this._update()},e.prototype._update=function(){return n.setItem(this.fullCacheKey(),{value:this.value,dirty:this.dirty})},e}()}},{"./cache":2}],11:[function(e,r,t){var n;n=6e4,r.exports=function(r,t){var o,u,a,i,s,c,l;return o=r.$log,a=e("./resource_cache_entry")(r),u=e("./cache")(r),s={},c=function(e){var r;return r=t.defer(),s[e.key]=r,e.promise=r.promise,r},l=function(e){return s[e.key].resolve()},i=function(){function e(e,r){var t,n,o,a;for(this.CachedResource=e,this.$timeout=r,this.key=""+this.CachedResource.$key+"/write",this.queue=u.getItem(this.key,[]),a=this.queue,n=0,o=a.length;o>n;n++)t=a[n],t.busy=!1;c(this),0===this.queue.length&&l(this)}return e.prototype.logStatusOfRequest=function(e,r,t,n){return o.debug(""+r+" for "+this.key+" "+angular.toJson(t)+" "+e+" (queue length: "+this.queue.length+")",n)},e.prototype.enqueue=function(e,r,t,n){var o,u,a,i;return 0===this.queue.length&&c(this),o=angular.isArray(r)?r.map(function(e){return e.$params()}):r.$params(),u=this.findWrite({params:e,action:t}),null==u?(this.queue.push({params:e,resourceParams:o,action:t,deferred:n}),this._update()):(null!=(a=u.deferred)&&a.promise.then(function(e){return n.resolve(e)}),null!=(i=u.deferred)&&i.promise["catch"](function(e){return n.reject(e)})),this.logStatusOfRequest("enqueued",t,e,r)},e.prototype.findWrite=function(e){var r,t,n,o,u,a;for(r=e.action,t=e.params,a=this.queue,o=0,u=a.length;u>o;o++)if(n=a[o],r===n.action&&angular.equals(t,n.params))return n},e.prototype.removeWrite=function(e){var r,t,n,o,u,a,i;for(r=e.action,o=e.params,n=[],i=this.queue,u=0,a=i.length;a>u;u++)t=i[u],r===t.action&&angular.equals(o,t.params)||n.push(t);return this.queue=n,0===this.queue.length&&this.timeoutPromise&&(this.$timeout.cancel(this.timeoutPromise),delete this.timeoutPromise),this._update(),0===this.queue.length?l(this):void 0},e.prototype.flush=function(e){var r,t,n,o,u;for(angular.isFunction(e)&&this.promise.then(e),this._setFlushTimeout(),o=this.queue,u=[],t=0,n=o.length;n>t;t++)r=o[t],u.push(this._processWrite(r));return u},e.prototype.processResource=function(e,r){var t,n,o,u,a,i;for(t=!0,a=this._writesForResource(e),i=[],o=0,u=a.length;u>o;o++)n=a[o],i.push(this._processWrite(n,function(n){return function(){return t&&0===n._writesForResource(e).length?(t=!1,r()):void 0}}(this)));return i},e.prototype._writesForResource=function(e){var r,t,n,o,u;for(o=this.queue,u=[],t=0,n=o.length;n>t;t++)r=o[t],angular.equals(e,r.params)&&u.push(r);return u},e.prototype._processWrite=function(e,r){var t,n,u,i;if(!e.busy)return e.busy=!0,angular.isArray(e.resourceParams)?(t=e.resourceParams.map(function(e){return function(r){return new a(e.CachedResource.$key,r).load()}}(this)),i=t.map(function(e){return e.value})):(t=[new a(this.CachedResource.$key,e.resourceParams).load()],i=t[0].value),u=function(t){return function(n){var o;return t.removeWrite(e),null!=(o=e.deferred)&&o.resolve(n),t.logStatusOfRequest("succeeded",e.action,e.resourceParams,i),angular.isFunction(r)?r():void 0}}(this),n=function(r){return function(t){var n;return t&&t.status>=400&&t.status<500?(r.removeWrite(e),o.error(""+e.action+" to "+r.CachedResource.$key+" failed with error "+t.status,{method:t.config.method,url:t.config.url,writeData:i})):(e.busy=!1,r.logStatusOfRequest("failed with error "+angular.toJson(t)+"; still in queue",e.action,e.resourceParams,i)),null!=(n=e.deferred)?n.reject(t):void 0}}(this),this.CachedResource.$resource[e.action](e.params,i,u,n).$promise.then(function(e){return function(r){var t,n,o,u,i,s;for(r=angular.isArray(r)?r:[r],s=[],u=0,i=r.length;i>u;u++)n=r[u],o=new e.CachedResource(n),t=new a(e.CachedResource.$key,o.$params()).load(),s.push(t.set(n,!1));return s}}(this)),this.logStatusOfRequest("processed",e.action,e.resourceParams,i)},e.prototype._setFlushTimeout=function(){return this.queue.length>0&&!this.timeoutPromise?(this.timeoutPromise=this.$timeout(angular.bind(this,this.flush),n),this.timeoutPromise.then(function(e){return function(){return delete e.timeoutPromise,e._setFlushTimeout()}}(this))):void 0},e.prototype._update=function(){var e;return e=this.queue.map(function(e){return{params:e.params,resourceParams:e.resourceParams,action:e.action}}),u.setItem(this.key,e)},e}()}},{"./cache":2,"./resource_cache_entry":10}],12:[function(e,r,t){var n,o;n=e("./modify_object_in_place"),r.exports=o=function(r,t,o,u,a){var i;return i=e("./resource_cache_entry")(t),function(){var e,t,s,c,l,h,f,p,d,y,m,g,v,_,$,w,b,P;if(h=this instanceof u,e=Array.prototype.slice.call(arguments),y=!h&&angular.isObject(e[1])?e.shift():h&&angular.isObject(e[0])?e.shift():{},s=h?this:e.shift(),v=e[0],l=e[1],f=angular.isArray(s),p=!a.cacheOnly,$=function(e){return e instanceof u?e:new u(e)},f)for(s=s.map(function(e){return $(e)}),w=0,b=s.length;b>w;w++)g=s[w],t=new i(u.$key,g.$params()).load(),angular.equals(t.data,g)||t.set(g,p);else{s=$(s),P=s.$params();for(d in P)_=P[d],y[d]=_;t=new i(u.$key,s.$params()).load(),angular.equals(t.data,s)||t.set(s,p)}return s.$resolved=!1,c=r.defer(),s.$promise=c.promise,angular.isFunction(v)&&c.promise.then(v),angular.isFunction(l)&&c.promise["catch"](l),a.cacheOnly?(s.$resolved=!0,c.resolve(s)):(m=r.defer(),m.promise.then(function(e){return t.load(),n(s,e,t.value),s.$resolved=!0,c.resolve(s)}),m.promise["catch"](c.reject),u.$writes.enqueue(y,s,o,m),u.$writes.flush()),s}}},{"./modify_object_in_place":5,"./resource_cache_entry":10}]},{},[4]);